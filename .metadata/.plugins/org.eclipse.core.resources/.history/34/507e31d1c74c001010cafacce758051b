package in.tejas.utils;

import java.util.List;

import org.springframework.beans.factory.annotation.Autowired;

import com.lowagie.text.Document;
import com.lowagie.text.Font;
import com.lowagie.text.FontFactory;
import com.lowagie.text.PageSize;
import com.lowagie.text.Paragraph;
import com.lowagie.text.pdf.PdfPTable;
import com.lowagie.text.pdf.PdfWriter;

import in.tejas.entity.CitizenPlan;
import in.tejas.repo.CitizenPlanRepo;
import jakarta.servlet.http.HttpServletResponse;

public class PdfGenerator {
	
		@Autowired
		private CitizenPlanRepo planRepo;
		
		public void generate(HttpServletResponse response) {
			Document document = new Document(PageSize.A4);
			PdfWriter.getInstance(document,response.getOutputStream());
			document.open();
			// Creating font
			// Setting font style and size
			Font fontTiltle = FontFactory.getFont(FontFactory.TIMES_ROMAN);
			fontTiltle.setSize(20);
			// Creating paragraph
			Paragraph paragraph = new Paragraph("Citizens Plan", fontTiltle);
			// Aligning the paragraph in document
			paragraph.setAlignment(Paragraph.ALIGN_CENTER);
			// Adding the created paragraph in document
			document.add(paragraph);
			Paragraph p = new Paragraph(" ");
			document.add(p);
			
			PdfPTable table = new PdfPTable(6);
			table.addCell("Id");
			table.addCell("Citizen Name");
			table.addCell("Plan Name");
			table.addCell("Plan Status");
			table.addCell("Start Date");
			table.addCell("End Date");
			
			
			List<CitizenPlan> plans = planRepo.findAll();
			
			for(CitizenPlan plan : plans) {
				table.addCell(String.valueOf(plan.getCitizenid()));
				table.addCell(plan.getCitizename());
				table.addCell(plan.getPlanName());
				table.addCell(plan.getPlanStatus());
				table.addCell(plan.getPlanStartDate()+"");
				table.addCell(plan.getPlanEndDate()+"");
		}
			
			document.add(table);
			document.close();
			
		}
}
